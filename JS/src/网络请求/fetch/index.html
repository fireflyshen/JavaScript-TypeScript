<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      // 分派请求
      // fetch()只有一个必需的参数 input。多数情况下，这个参数是要获取资源的 URL。这个方法返回一个期约
      // let r = fetch("https://jsonplaceholder.typicode.com/posts");
      // console.log(r);

      // // 请求完成、资源可用时，期约会解决为一个 Response 对象。这个对象是 API 的封装，可以通过它 取得相应资源。获取资源要使用这个对象的属性和方法，掌握响应的情况并将负载转换为有用的形式， 如下所示:
      // fetch("https://jsonplaceholder.typicode.com/posts").then((response) => console.log(response));

      // // 读取响应内容的最简单方式是取得纯文本格式的内容，这要用到 text()方法。
      // var data = fetch("https://jsonplaceholder.typicode.com/posts").then((response) => response.text().then(e => console.log(e)));
      // console.log(data);

      // // 处理状态码和请求失败
      // fetch("https://jsonplaceholder.typicode.com/posts").then((response) => {
      //     console.log(response.status);
      //     console.log(response.statusText,"@");
      // } );

      // // 404状态吗
      // fetch("https://jsonplaceholder.typicode.com/post").then((response) => {
      //     console.log(response.status);
      //     console.log(response.statusText,"@");
      // })

      // 错误处理，如果出现了fetch fail的情况就会出现走then函数的第二个错误回调，否则会走第一个，出现了404，500的情况就是也是成功
      fetch("https://jsonplaceholder.typcode.com/post").then(
        (res) => console.log(res, "@"),
        (err) => console.log(err, "$")
      );

      // 违反 CORS、无网络连接、HTTPS 错配及其他浏览器/网络策略问题都会导致期约被拒绝。 可以通过 url 属性检查通过 fetch()发送请求时使用的完整 URL:
      // foo.com/bar/baz 发送的请求 console.log(window.location.href); // https://foo.com/bar/baz
      fetch("qux").then((response) => console.log(response.url)); // https://foo.com/bar/qux
      fetch("/qux").then((response) => console.log(response.url)); // https://foo.com/qux
      fetch("//qux.com").then((response) => console.log(response.url),(err) => {
        console.log(err);
      }); // https://qux.com
      fetch("https://qux.com").then((response) => console.log(response.url),(err) => {
        console.log(err);
      }); // https://qux.com
    </script>
  </body>
</html>
